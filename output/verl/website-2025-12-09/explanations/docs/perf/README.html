<h1>docs/perf</h1>
<p>这是一个非常形象的问题。如果把训练大模型比作<strong>“组建一支 F1 赛车队去参加比赛”</strong>，那么 <code>docs/perf</code> 这个文件夹就是你的<strong>“王牌技师团队与改装手册”</strong>。</p>
<p>这里不讲怎么造轮子（写代码），只讲<strong>怎么让车跑得飞快、怎么省油、怎么防止引擎过热爆炸</strong>。</p>
<hr />
<h3>1. 这个文件夹主要负责什么功能？</h3>
<p><strong>核心功能：性能压榨与体检。</strong></p>
<p>它的存在只有一个目的：<strong>帮你省钱、省时间</strong>。
因为训练大模型（特别是强化学习 RLHF）非常烧钱，显卡稍微空转一会儿就是几十美元没了。这个文件夹里的文档都在教你如何把 GPU 的性能榨干到最后一滴，以及当速度慢下来时，如何像医生一样去诊断病因。</p>
<hr />
<h3>2. 各个文件分别是干什么的？</h3>
<p>我们可以把这些文件看作赛车队里不同职能的手册：</p>
<ul>
<li>
<p><strong>🏎️ 赛车驾驶指南 (best_practices.rst)</strong></p>
<ul>
<li><strong>角色</strong>：<strong>总教练</strong>。</li>
<li><strong>作用</strong>：教你“怎么开”。针对特定的大模型（如 Qwen），告诉你方向盘打多少度（参数怎么设）、油门踩多深（步数怎么定），才能跑出最好成绩。它是数学公式到代码配置的最佳实践。</li>
</ul>
</li>
<li>
<p><strong>💻 硬件准入清单 (device_tuning.rst)</strong></p>
<ul>
<li><strong>角色</strong>：<strong>采购经理</strong>。</li>
<li><strong>作用</strong>：告诉你“能不能跑”。你想跑 70B 的模型？它会查表告诉你：“兄弟，你至少得有 4 张 H100，否则别想了。”这是为了防止你买错显卡或者配置不够导致爆显存。</li>
</ul>
</li>
<li>
<p><strong>🦖 巨兽驯化手册 (dpsk.md)</strong></p>
<ul>
<li><strong>角色</strong>：<strong>重型机械专家</strong>。</li>
<li><strong>作用</strong>：专门针对<strong>DeepSeek-V3 (671B)</strong> 这种“哥斯拉”级别的超大模型。普通车库放不下，它教你如何把这只巨兽拆解开（切分模型），塞进几百张显卡里去训练。</li>
</ul>
</li>
<li>
<p><strong>🛠️ 引擎改装秘籍 (perf_tuning.rst)</strong></p>
<ul>
<li><strong>角色</strong>：<strong>首席改装技师</strong>。</li>
<li><strong>作用</strong>：教你“怎么改”。觉得原厂配置太慢？这里教你如何开启“氮气加速”（vLLM加速、动态Batch、去除Padding），让吞吐量翻倍，显存占用减半。</li>
</ul>
</li>
<li>
<p><strong>🩺 CT扫描操作书 (nsight_profiling.md)</strong></p>
<ul>
<li><strong>角色</strong>：<strong>队医（操作层面）</strong>。</li>
<li><strong>作用</strong>：教你“怎么查病”。当车跑不快时，教你如何使用 Nsight Systems 这台“CT机”，给代码做全身扫描，看看到底是 CPU 慢了还是 GPU 在偷懒。</li>
</ul>
</li>
<li>
<p><strong>⚙️ 医疗设备说明书 (verl_profiler_system.md)</strong></p>
<ul>
<li><strong>角色</strong>：<strong>医疗器械研发</strong>。</li>
<li><strong>作用</strong>：给<strong>开发这套系统的人</strong>看的。如果你觉得现有的检查工具不够好，想给 verl 造一个新的探针或者监控器，这份文档告诉你系统的内部线路是怎么连的。</li>
</ul>
</li>
</ul>
<hr />
<h3>3. 给我一个高层认知（上帝视角）</h3>
<p>要理解这部分代码，你只需要记住<strong>“多快好省”</strong>这四个字在 AI 训练中的映射：</p>
<ol>
<li><strong>门槛（能跑吗？）</strong>：先看 <code>device_tuning</code> 和 <code>dpsk</code>，确认你的显卡能不能装下这个模型。</li>
<li><strong>效率（快不快？）</strong>：再看 <code>perf_tuning</code>，把各种加速开关（vLLM, FlashAttention 等）都打开，把显存塞满。</li>
<li><strong>效果（好不好？）</strong>：参考 <code>best_practices</code>，设置正确的算法参数（DAPO/GRPO），确保模型能学到东西。</li>
<li><strong>诊断（卡哪了？）</strong>：如果以上都做了还是很慢，就用 <code>nsight_profiling</code> 里的方法去抓“内鬼”。</li>
</ol>
<p><strong>一句话总结：</strong>
<code>docs/perf</code> 不教你写 AI 算法，它教你<strong>如何驾驭算力</strong>。它是连接“昂贵的显卡”和“聪明的模型”之间的那本<strong>操作说明书</strong>。</p>