<h1>docs/start/install.rst</h1>
<p>这份文档主要是在讲 <strong>如何安装 <code>verl</code> 这一强化学习训练框架</strong>。</p>
<p>因为涉及深度学习、大模型训练（Training）和推理（Inference/Rollout），它的依赖环境比较复杂。文档提供了“简单模式（Docker）”和“困难模式（手动配置）”。</p>
<p>为了让你看懂，我先把文中的<strong>核心概念（观点）</strong>梳理清楚，然后给你列一个<strong>决策清单</strong>，最后给你一个<strong>一步步执行的 To-Do List</strong>。</p>
<hr />
<h3>第一部分：文中的核心概念（大白话解释）</h3>
<p>在安装之前，文档先解释了 <code>verl</code> 的架构逻辑，你需要理解这两个概念：</p>
<ol>
<li>
<p><strong>任务拆分：训练 vs 推理</strong></p>
<ul>
<li><code>verl</code> 把“训练模型（怎么改参数）”和“模型生成数据（怎么写回复）”分开了。你需要为这两个环节分别选择后端引擎。</li>
</ul>
</li>
<li>
<p><strong>后端的选择（Choices of Backend Engines）</strong></p>
<ul>
<li><strong>训练端（Training）：</strong><ul>
<li><strong>FSDP (推荐):</strong> 适合搞研究、做原型、跑中小模型。配置简单。</li>
<li><strong>Megatron-LM:</strong> 适合追求极致扩展性、跑超大模型。配置复杂（需要专门的 Workers）。</li>
</ul>
</li>
<li><strong>推理端（Inference/Rollout）：</strong><ul>
<li><strong>vLLM (推荐):</strong> 也就是生成文本用的。v0.8.3+ 版本很稳定，建议用。</li>
<li><strong>SGLang:</strong> 功能更高级，速度可能更快，但开发变动大。</li>
<li><strong>TGI:</strong> 通常只用来调试或单卡测试。</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr />
<h3>第二部分：你的决策清单 (Checklist)</h3>
<p>在开始动手前，请先确认以下几点：</p>
<ul>
<li>[ ] <strong>硬件检查</strong>：你的显卡支持 CUDA 12.8 吗？（通常需要较新的显卡驱动）。</li>
<li>[ ] <strong>操作系统</strong>：是 Linux 吗？（通常这类框架都在 Linux 下跑）。</li>
<li>[ ] <strong>选择安装方式</strong>：<ul>
<li><strong>方案 A（强烈推荐）：使用 Docker。</strong> 官方把环境都打好包了，下载即用，省去 90% 的报错烦恼。</li>
<li><strong>方案 B（不推荐）：手动安装。</strong> 需要自己装 CUDA、cuDNN、Apex 等，容易因为版本冲突导致失败。</li>
<li><strong>方案 C（特殊情况）：AMD 显卡。</strong> 如果你用的是 AMD MI300 显卡，必须走专门的 ROCm 流程。</li>
</ul>
</li>
</ul>
<hr />
<h3>第三部分：执行任务 To-Do List (一步步操作)</h3>
<p>既然你觉得难懂，我建议你直接走 <strong>方案 A (Docker)</strong>。如果实在不能用 Docker，再看后面的手动方案。</p>
<h4>🚀 路径一：使用 Docker 安装 (推荐，最省心)</h4>
<p><strong>Step 1: 准备 Docker 环境</strong>
*   确保你的机器上安装了 Docker 和 NVIDIA Container Toolkit（能让 Docker 调用显卡）。</p>
<p><strong>Step 2: 拉取并启动容器</strong>
*   官方已经做好了镜像，里面包含了 vLLM, Megatron, Apex 等难装的东西。
*   <strong>执行命令</strong>（在终端运行）：
    ```bash
    # 创建并启动一个名为 verl 的容器
    docker create --runtime=nvidia --gpus all --net=host --shm-size="10g" --cap-add=SYS_ADMIN -v .:/workspace/verl --name verl verlai/verl:vllm011.latest sleep infinity</p>
<div class="codehilite"><pre><span></span><code><span class="gh">#</span> 启动容器
docker start verl

<span class="gh">#</span> 进入容器内部
docker exec -it verl bash
```
<span class="gs">*(注：原文命令里的 `&lt;image:tag&gt;` 我帮你替换成了文中提到的一个具体镜像 `verlai/verl:vllm011.latest`，你也可以去 dockerhub 找最新的)*</span>
</code></pre></div>

<p><strong>Step 3: 安装 verl 主程序</strong>
*   进入容器后，你只需要安装 <code>verl</code> 这个代码库本身。
*   <strong>执行命令</strong>：
    ```bash
    # 下载代码
    git clone https://github.com/volcengine/verl &amp;&amp; cd verl</p>
<div class="codehilite"><pre><span></span><code># 安装（--no-deps 表示不安装依赖，因为镜像里都有了）
pip3 install --no-deps -e .
```
</code></pre></div>

<p><strong>Step 4: 完成！</strong>
*   现在你可以开始跑代码了。</p>
<hr />
<h4>🛠️ 路径二：手动安装 (Conda 环境，容易踩坑)</h4>
<p>如果你无法使用 Docker，必须在自己的服务器环境里装，请按这个顺序：</p>
<p><strong>Step 1: 安装系统级依赖 (最麻烦的一步)</strong>
*   <strong>CUDA:</strong> 必须 &gt;= 12.8。
*   <strong>cuDNN:</strong> 必须 &gt;= 9.10.0。
*   <strong>Apex:</strong> NVIDIA 的加速库，安装很慢。
*   <em>文中提供了详细的 <code>wget</code> 和 <code>apt-get</code> 命令来安装这些，你需要有 root 权限。</em></p>
<p><strong>Step 2: 创建 Python 环境</strong>
*   建议用 Conda 隔离环境。
    <code>bash
    conda create -n verl python==3.12
    conda activate verl</code></p>
<p><strong>Step 3: 运行一键安装脚本</strong>
*   官方为了防止版本冲突，写了个脚本帮你装 vLLM 和 SGLang 等依赖。
    ```bash
    # 先克隆代码
    git clone https://github.com/volcengine/verl &amp;&amp; cd verl</p>
<div class="codehilite"><pre><span></span><code><span class="gh">#</span> 运行脚本安装依赖 (如果你只用 FSDP 训练，不装 Megatron)
USE_MEGATRON=0 bash scripts/install_vllm_sglang_mcore.sh
```
</code></pre></div>

<p><strong>Step 4: 安装 verl</strong>
    <code>bash
    pip install --no-deps -e .</code></p>
<p><strong>Step 5: 检查版本冲突 (Post-installation)</strong>
*   手动安装最怕的就是包被覆盖。最后要检查 <code>torch</code>, <code>vLLM</code>, <code>pyarrow</code> 这些包的版本是不是匹配。</p>
<hr />
<h3>总结</h3>
<p>这篇文档其实就讲了三件事：
1.  <strong>选后端</strong>：一般人选 FSDP (训练) + vLLM (推理)。
2.  <strong>怎么装</strong>：首选 Docker，实在不行再手动配环境。
3.  <strong>特殊硬件</strong>：如果你是 AMD 显卡，去看文档最后那段专门的 Dockerfile 构建教程。</p>
<p><strong>建议你直接按照【路径一：使用 Docker 安装】的步骤操作即可。</strong></p>