<h1>verl/trainer/config/evaluation.yaml</h1>
<p>这个文件其实是一个<strong>“考试说明书”</strong>。</p>
<p>在训练大模型（尤其是用强化学习训练）时，我们需要定期给模型“考试”，看看它学得怎么样。这个 <code>.yaml</code> 文件就是告诉计算机：<strong>去哪里拿考卷、怎么改卷子、以及用多少计算资源来组织这场考试。</strong></p>
<p>为了让你彻底看懂，我为你列了一个 <strong>4步走的 Task List（任务清单）</strong>，我们一步步把这个文件“拆解”开来。</p>
<hr />
<h3>📝 任务清单 (Task List)</h3>
<h4>✅ Task 1: 搞懂“我们要考什么？” (Data 部分)</h4>
<p><strong>目标</strong>：告诉程序去哪里读取测试题，以及数据长什么样。</p>
<p>文中的代码：</p>
<div class="codehilite"><pre><span></span><code><span class="nt">data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tmp/math_Qwen2-7B-Instruct.parquet</span>
<span class="w">  </span><span class="nt">prompt_key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prompt</span>
<span class="w">  </span><span class="nt">response_key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">responses</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>

<p><strong>解读步骤：</strong>
1.  <strong><code>path</code> (考卷在哪里)</strong>:
    *   这里指定了一个文件路径 <code>/tmp/math_Qwen2-7B-Instruct.parquet</code>。
    *   <code>.parquet</code> 是一种类似 Excel 的数据格式。你可以把它想象成一个巨大的表格，里面存满了数学题。
2.  <strong><code>*_key</code> (怎么读表格)</strong>:
    *   程序不知道表格里哪一列是“题目”，哪一列是“标准答案”。
    *   <code>prompt_key: prompt</code>: 告诉程序，表格里叫 <code>prompt</code> 的那一列是<strong>题目</strong>。
    *   <code>response_key: responses</code>: 告诉程序，表格里叫 <code>responses</code> 的那一列是<strong>模型的回答</strong>（或者是参考答案）。</p>
<h4>✅ Task 2: 搞懂“怎么打分？” (Reward 部分)</h4>
<p><strong>目标</strong>：模型做完题后，需要有一个“阅卷老师”来打分。</p>
<p>文中的代码：</p>
<div class="codehilite"><pre><span></span><code><span class="nt">custom_reward_function</span><span class="p">:</span>
<span class="w">  </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">compute_score</span>
</code></pre></div>

<p><strong>解读步骤：</strong>
1.  <strong><code>name: compute_score</code> (阅卷规则)</strong>:
    *   这里指定了一个叫 <code>compute_score</code> 的函数。
    *   它的作用是：看模型的答案对不对。比如这是数学题，它会检查模型算出的数是不是和标准答案一样。如果一样给高分，不一样给低分。
2.  <strong><code>path: null</code></strong>:
    *   <code>null</code> 表示没有指定额外的外部文件路径，说明这个 <code>compute_score</code> 函数可能已经内置在主程序里了，直接用就行。</p>
<h4>✅ Task 3: 搞懂“用什么考场？” (Ray 部分)</h4>
<p><strong>目标</strong>：配置底层的计算资源。这个 <code>verl</code> 框架使用了一个叫 <strong>Ray</strong> 的工具来管理多台计算机（或多个CPU核心）并行工作。</p>
<p>文中的代码：</p>
<div class="codehilite"><pre><span></span><code><span class="nt">ray_kwargs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ray_init</span><span class="p">:</span>
<span class="w">    </span><span class="nt">num_cpus</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span><span class="w"> </span>
<span class="w">  </span><span class="nt">timeline_json_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</code></pre></div>

<p><strong>解读步骤：</strong>
1.  <strong><code>num_cpus: null</code> (分配多少个监考员/CPU)</strong>:
    *   这是最关键的一行。
    *   <code>null</code> (即 None) 的意思是：<strong>“有多少用多少”</strong>，把电脑上所有的 CPU 核心全占满。
    *   <strong>注意警告</strong>：代码后的注释提醒你，如果你在学校或公司的集群（如 SLURM 系统）上跑，<strong>千万别填 null</strong>，否则可能会因为抢占资源导致程序卡死（hang）。你应该填一个具体的数字，比如 <code>8</code> 或 <code>16</code>。
2.  <strong><code>timeline_json_file: null</code></strong>:
    *   这是用来记录“考试过程流水账”的日志文件。填 <code>null</code> 表示不需要记录详细的时间线日志，省点硬盘空间。</p>
<h4>✅ Task 4: 总结全貌</h4>
<p><strong>目标</strong>：把上面三个部分串起来。</p>
<p><strong>一句话总结这个文件的作用：</strong></p>
<blockquote>
<p>“请使用 <strong>Ray 框架</strong>（如果不指定就占满所有CPU），去读取 <strong><code>/tmp/...parquet</code></strong> 这个文件里的数学题，让模型做完后，用内置的 <strong><code>compute_score</code></strong> 函数来给模型打分，看看它考了多少分。”</p>
</blockquote>
<hr />
<h3>💡 你的下一步行动 (Action Items)</h3>
<p>如果你需要修改这个文件来运行你自己的任务，你需要做以下 3 件事：</p>
<ol>
<li><strong>修改数据路径</strong>：把 <code>data.path</code> 改成你自己的测试集文件路径。</li>
<li><strong>确认列名</strong>：打开你的数据文件，看看题目那一列叫什么（比如叫 <code>question</code>?），然后修改 <code>prompt_key</code> 对应的值。</li>
<li><strong>设置 CPU 数量</strong>：为了安全起见，建议把 <code>num_cpus: null</code> 改成一个具体的数字（比如 <code>num_cpus: 8</code>），防止电脑卡死。</li>
</ol>